name: "Promote draft release"
on:
  release:
    types: [published]
jobs:
  promote:
    runs-on: self-hosted-novum
    steps:
      - name: Checkout repo
        uses: actions/checkout@v2

      - name: Close and promote staging repository
        uses: docker://docker.tuenti.io/android/mistica_builder:2
        with:
          args: './gradlew closeAndReleaseRepository -DSTAGING_PROFILE_ID="$(./gradlew getStagingProfile  | sed -n -e "s/^Received staging profile id: //p")"'

